http://www.darwinwars.com/lunatic/bugs/oo_macros.html